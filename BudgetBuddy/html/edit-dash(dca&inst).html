<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>แก้ไขข้อมูลธุรกรรม</title>
  <!-- Google Font -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="../css/edit-dash(dca&inst).css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
 <!-- Font Awesome (icons) -->
 <link
 rel="stylesheet"
 href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css"
 referrerpolicy="no-referrer"
/>
</head>
<body>
<!-- SIDEBAR -->
<div class="sidebar">
 <ul class="menu">
     <li><a href="start.html"><i class="fas fa-bullseye"></i> กำหนดเป้าหมายใหม่</a></li>
     <li><a href="calendar.html"><i class="fas fa-calendar-alt"></i> ปฏิทินรายรับ-รายจ่าย</a></li>
     <li><a href="dashboardsav(before).html"><i class="fas fa-file-alt"></i> รายงานธุรกรรม</a></li>
     
     <li class="has-submenu">
         <a href="#" class="toggle-submenu"><i class="fas fa-chart-line"></i> ลงทุนDCA </a>
         <ul class="submenu">
             <li><a href="calculator.html">คำนวณDCA</a></li>
             <li><a href="dca-progress.html">ความคืบหน้าของDCA</a></li>
         </ul>
     </li>

     <li class="has-submenu">
         <a href="#" class="toggle-submenu"><i class="fas fa-credit-card"></i> การชำระผ่อน </a>
         <ul class="submenu">
             <li><a href="install-plan.html">แบบจำลองการซ้อมผ่อน</a></li>
             <li><a href="install-progress.html">ความคืบหน้าของการซ้อมผ่อน</a></li>
         </ul>
     </li>

     <li class="has-submenu">
         <a href="#" class="toggle-submenu"><i class="fas fa-piggy-bank"></i> การออมเงิน </a>
         <ul class="submenu">
             <li><a href="saving-progress.html">ความคืบหน้าของการออมเงิน</a></li>
         </ul>
     </li>

     <li><a href="adjust.html"><i class="fas fa-cogs"></i> ปรับแผนการเงิน</a></li>
 </ul>
</div>
  <div class="container">
    <div class="header">
      <div class="title">รายการธุรกรรม</div>
      <div class="subtitle">มกราคม <strong>2568</strong></div>
    </div>

    <canvas id="transactionChart" class="chart"></canvas>

    <div class="edit-section">
      <div class="edit-item">
        <label for="income" class="form-label">รายรับ:</label>
        <input type="number" id="income" class="form-input" value="18000" required>
      </div>
      <div class="edit-item">
        <label for="expense" class="form-label">รายจ่าย:</label>
        <input type="number" id="expense" class="form-input" value="12000" required>
      </div>
      <div class="edit-item">
        <label for="savings" class="form-label">เงินออม (DCA, ซ้อมผ่อน):</label>
        <input type="number" id="savings" class="form-input" value="2400" required>
      </div>
      <div class="edit-item">
        <label for="debt" class="form-label">หนี้สิน:</label>
        <input type="number" id="debt" class="form-input" value="1000" required>
      </div>
    </div>

    <button type="button" class="submit-button" onclick="updateChart(); window.location.href='dashboarddca&inst(after).html';">
      บันทึก
    </button>
  </div>

  <script>
    const canvas = document.getElementById('transactionChart');
    const ctx = canvas.getContext('2d');

    // Adjust canvas resolution for high-DPI devices
    function setCanvasResolution(canvas) {
      const pixelRatio = window.devicePixelRatio || 1;
      canvas.width = canvas.clientWidth * pixelRatio;
      canvas.height = canvas.clientHeight * pixelRatio;
      canvas.style.width = `${canvas.clientWidth}px`;
      canvas.style.height = `${canvas.clientHeight}px`;
      ctx.scale(pixelRatio, pixelRatio);
    }
    setCanvasResolution(canvas);

    // Initialize chart
    let transactionChart = new Chart(ctx, {
      type: 'bar',
      data: {
        labels: ['รายรับ', 'รายจ่าย', 'เงินออม (DCA, ซ้อมผ่อน)', 'หนี้สิน', 'เงินคงเหลือ'],
        datasets: [{
          label: 'จำนวนเงิน (บาท)',
          data: [18000, 12000, 2400, 1000, 4000],
          backgroundColor: ['#28a745', '#dc3545', '#007bff', '#ff0000', '#ffc107']
        }]
      },
      options: {
        responsive: true,
        plugins: {
          legend: { display: false }
        },
        scales: {
          y: {
            beginAtZero: true,
            ticks: {
              callback: function(value) {
                return value.toLocaleString() + ' บาท';
              }
            }
          }
        }
      }
    });

    // Update chart data based on input values
    function updateChart() {
      const income = parseFloat(document.getElementById('income').value);
      const expense = parseFloat(document.getElementById('expense').value);
      const savings = parseFloat(document.getElementById('savings').value);
      const debt = parseFloat(document.getElementById('debt').value);
      // Calculate remaining as income minus (expense + savings + debt)
      const remaining = income - expense - savings - debt;

      transactionChart.data.datasets[0].data = [income, expense, savings, debt, remaining];
      transactionChart.update();
    }
  </script>


</script>

<script src="/BudgetBuddy/javascript/nav.js"></script>
</body>
</html>
