<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ความคืบหน้าการออมเงิน</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@100;200;300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../css/dashboard.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <div class="sidebar">
        <ul class="menu">
            <li><a href="start.html"><i class="fas fa-bullseye"></i> กำหนดเป้าหมายใหม่</a></li>
            <li><a href="calendar.html"><i class="fas fa-calendar-alt"></i> ปฏิทินรายรับ-รายจ่าย</a></li>
            <li><a href="dashboard(before).html"><i class="fas fa-file-alt"></i> รายงานธุรกรรม</a></li>
            
            <li class="has-submenu">
                <a href="#" class="toggle-submenu"><i class="fas fa-chart-line"></i> ลงทุนDCA <i class="fas fa-chevron-down arrow"></i></a>
                <ul class="submenu">
                    <li><a href="calculator.html">คำนวณDCA</a></li>
                    <li><a href="dca-progress.html">ความคืบหน้าของDCA</a></li>
                </ul>
            </li>
    
            <li class="has-submenu">
                <a href="#" class="toggle-submenu"><i class="fas fa-credit-card"></i> การชำระผ่อน <i class="fas fa-chevron-down arrow"></i></a>
                <ul class="submenu">
                    <li><a href="install-plan.html">แบบจำลองการซ้อมผ่อน</a></li>
                    <li><a href="install-progress.html">ความคืบหน้าของการซ้อมผ่อน</a></li>
                </ul>
            </li>
    
            <li class="has-submenu">
                <a href="#" class="toggle-submenu"><i class="fas fa-piggy-bank"></i> การออมเงิน <i class="fas fa-chevron-down arrow"></i></a>
                <ul class="submenu">
                    <li><a href="saving-progress.html">ความคืบหน้าของการออมเงิน</a></li>
                </ul>
            </li>
    
            <li><a href="adjust.html"><i class="fas fa-cogs"></i> ปรับแผนการเงิน</a></li>
        </ul>
    </div>
    
    <div class="container">

        <!-- Title -->
        <h2 class="title">ความคืบหน้าการออมเงิน</h2>
        
        <!-- Savings Progress -->
        <p class="savings-progress">
            ออมไปแล้ว <span class="highlight">2,500</span> บาท จากเป้าหมาย <span class="highlight-goal">20,000</span> บาท
        </p>

        <!-- Chart Container -->
        <div class="chart-container">
            <canvas id="savingsChart"></canvas>
        </div>
    </div>

    <script>
        const ctx = document.getElementById('savingsChart').getContext('2d');

        // Data for savings progress
        const savedAmount = 2500;
        const goalAmount = 20000;
        const progressPercentage = ((savedAmount / goalAmount) * 100).toFixed(1);
        const remainingPercentage = (100 - progressPercentage).toFixed(1);

        // Chart.js Plugin to add text inside the chart
        const centerText = {
            id: 'centerText',
            beforeDraw(chart) {
                const { width } = chart;
                const { height } = chart;
                const ctx = chart.ctx;
                ctx.restore();
                
                const fontSize = (height / 10).toFixed(2);
                ctx.font = `bold ${fontSize}px Prompt, sans-serif`;
                ctx.textBaseline = 'middle';
                ctx.textAlign = 'center';

                // Position the text in the center
                const text = `${progressPercentage}%`;
                const x = width / 2;
                const y = height / 2;
                ctx.fillText(text, x, y);

                ctx.save();
            }
        };

        new Chart(ctx, {
            type: 'doughnut',
            data: {
                labels: [`${progressPercentage}%`, `${remainingPercentage}%`],
                datasets: [{
                    data: [progressPercentage, remainingPercentage],
                    backgroundColor: ['#28a745', '#fbbc04'],
                    borderWidth: 2
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                cutout: '70%',
                plugins: {
                    legend: {
                        display: false
                    },
                    tooltip: {
                        enabled: false
                    }
                }
            },
            plugins: [centerText] // Add custom plugin to the chart
        });

        document.querySelectorAll('.toggle-submenu').forEach(menu => {
            menu.addEventListener('click', function(e) {
                e.preventDefault();
                
                let submenu = this.nextElementSibling;
    
                // Toggle submenu visibility
                submenu.classList.toggle('active');
    
                // Rotate the arrow
                this.classList.toggle('rotate');
    
                // Close other submenus when one is opened
                document.querySelectorAll('.submenu').forEach(sub => {
                    if (sub !== submenu) {
                        sub.classList.remove('active');
                        sub.previousElementSibling.classList.remove('rotate');
                    }
                });
            });
        });
    </script>

</body>
</html>
